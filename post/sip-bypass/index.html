<!DOCTYPE html>
<html lang="en">
<head>
  
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="author" content="Lime .inc">



  
  <meta name="description" content="A look into ways to circumvent Apple&#39;s System Integrity Protection">
  <meta name="keywords" content="[]">




  <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <base href="/lime">

  <title>LIME.inc</title>

  <link rel="canonical" href="https://limeincofficial.github.io/lime/post/sip-bypass/">
  

  


<link href="https://limeincofficial.github.io/lime/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />


<link href="https://limeincofficial.github.io/lime/vendor/nes-style/css/nes.min.css" rel="stylesheet" />


<link rel="stylesheet" href="https://limeincofficial.github.io/lime/css/bundle.min.d49afd00cf5df05be3c0cca664206dfa218cfc41d703886fe78201f755d87d76ff067731cf312bdb95b6afcb0c4dd730c5cdee9fc2ebc0cddfc76762f1d332e4.css" integrity="sha512-1Jr9AM9d8FvjwMymZCBt&#43;iGM/EHXA4hv54IB91XYfXb/BncxzzEr25W2r8sMTdcwxc3un8LrwM3fx2di8dMy5A==">


  <meta property="og:title" content="System Integrity Protection Bypass" />
<meta property="og:description" content="A look into ways to circumvent Apple&#39;s System Integrity Protection" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://limeincofficial.github.io/lime/post/sip-bypass/" /><meta property="og:image" content="https://avatars.githubusercontent.com/u/88994657?s=200&v=4"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-08-19T00:00:00+00:00" /><meta property="og:site_name" content="Lime Inc." />


  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/88994657?s=200&v=4"/>

<meta name="twitter:title" content="System Integrity Protection Bypass"/>
<meta name="twitter:description" content="A look into ways to circumvent Apple&#39;s System Integrity Protection"/>


  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>
</head>


<body class="bg-dark text-light  parallax" data-parallax-speed="10">
  <header>
  <div class="fixed-top p-5 bg-dark text-center">
    <h1 class="nes-text">LIME.inc</h1>
  </div>

  
  <nav>
  <div class="container my-5 text-center">
    <div class="row">
      <div class="col">
        
  
    
  
    
  
  
    <span>
      <a  href="https://limeincofficial.github.io/lime/">Home</a>
    </span>
    <span>/</span>
  

  
  
    <span>
      <a  href="https://limeincofficial.github.io/lime/post/">Posts</a>
    </span>
    <span>/</span>
  

  
  
    
  

      </div>
    </div>
  </div>
</nav>



</header>


  <main aria-role="main">
    
<article>
  <div class="container">

    <div class="row mb-5">
      <div class="col text-center">
        <h1 class="nes-text is-primary">System Integrity Protection Bypass</h1>
      </div>
    </div>

    <div class="d-flex justify-content-center m-5 text-muted">
      <small>
        <time datetime="2022-08-19 00:00:00 &#43;0000 UTC">2022.08.19</time>
        |
        <span id="readingtime">~3 minutes</span>
      </small>
    </div>
  
    <div class="row mb-5">
      <div class="col">
        <p><!-- raw HTML omitted --></p>
<h2 id="whats-system-integrity-protection-sip-and-why-do-we-care">What&rsquo;s System Integrity Protection (SIP) and Why Do We Care?</h2>
<p>According to Apple, &ldquo;System Integrity Protection is a security technology in OS X El Capitan and later that&rsquo;s designed to help prevent potentially malicious software from modifying protected files and folders on your Mac. System Integrity Protection restricts the root user account and limits the actions that the root user can perform on protected parts of the Mac operating system.</p>
<p>Before System Integrity Protection, the root user had no permission restrictions, so it could access any system folder or app on your Mac. Software obtained root-level access when you entered your administrator name and password to install the software. That allowed the software to modify or overwrite any system file or app.&rdquo;</p>
<p><strong>Apple also specefies what parts of system System Integrity Protection protects which are:</strong></p>
<ul>
<li><code>/System</code></li>
<li><code>/usr</code></li>
<li><code>/bin</code></li>
<li><code>/sbin</code></li>
<li><code>/var</code></li>
<li>Apps that are pre-installed with OS X</li>
</ul>
<p><strong>Protected Paths and apps that third-party apps and installers can continue to write to include:</strong></p>
<ul>
<li><code>/Applications</code></li>
<li><code>/Library</code></li>
<li><code>/usr/local</code></li>
</ul>
<p>Also, &ldquo;System Integrity Protection is designed to allow modification of these protected parts only by processes that are signed by Apple and have special entitlements to write to system files, such as Apple software updates and Apple installers. Apps that you download from the Mac App Store already work with System Integrity Protection. Other third-party software, if it conflicts with System Integrity Protection, might be set aside when you upgrade to OS X El Capitan or later.&rdquo; It also helps prevent software from selecting a startup disk but thats not important right now for our current goals.</p>
<p>;</p>
<h2 id="sip-and-notarized-code">SIP and Notarized Code</h2>
<p>With the introduction of notarized code Apple has pretty much made it standard to visit the security prefrences everytime they want to run un-notarized code. Any piece of software that doesn&rsquo;t have a valid code signature and isn&rsquo;t submitted via Apple&rsquo;s Xcode to be notarized will read as this:</p>
<p><!-- raw HTML omitted --></p>
<p>Which Mac users are conditioned to ignore (Maybe if Apple replaced this with a Virus Total Scan attached users would actually pay attention to this). Apple doesn&rsquo;t like code on your system that doesn&rsquo;t go through the notarization proccess so they won&rsquo;t protect it with SIP. This also includes privelaged applications that are un-notarized.</p>
<h2 id="exploiting-sip-misconfigurations">Exploiting SIP Misconfigurations</h2>
<p>I initially discovered this exploit while messing with cheat engine and attacking web assembely. Attaching a debugger to Proccess&rsquo;s that were protected by SIP (including applications that existed outside of SIP&rsquo;s protected directories) was blocked by the system.</p>
<p><!-- raw HTML omitted --></p>
<p>Now if we do the same thing to a non-notarized application we can observe how SIP ignores protection measures regardless of privelages. For demo I&rsquo;ll run libreWolf from the application folder (a un-notarized piece of software) and try to attach my debugger to it.</p>
<p><!-- raw HTML omitted --></p>
<h2 id="potential">Potential</h2>
<p>Malicious Agents with a foothold in the system as user could privelage escalate using SIP ignored non-notarized software as a gateway into root. Obviously this relies on a foothold on the system to be present. Apple could mitigate this with a simple update to allow for SIP protection to extend to non-notarized software as well. For now you can stop this midway by installing BlockBlock (<a href="https://objective-see.org/products/blockblock.html">https://objective-see.org/products/blockblock.html</a>) an open source tool by Objective-See to see whenever un-notarized code tries to launch and have the ability to block it before it runs.</p>

      </div>
    </div>

    <div class="row mb-5">
      <div class="col text-end text-right">
        By:  <em>Lime .inc</em>
      </div>
    </div>

  </div>
</article>

<aside id="meta">
  
  <div class="d-flex justify-content-center m-5">
    
    <a class="nes-badge mx-3" href="https://limeincofficial.github.io/lime/tags/mac" rel="tag">
      <span class="is-primary">Mac</span>
    </a>
    
  </div>
  

  

  
  <section id="comments">
    <div class="d-flex justify-content-center m-5">
      <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-limeincofficial-github-io-lime" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'https-limeincofficial-github-io-lime';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>
  </section>

  
  <div class="row d-flex justify-content-evenly m-5">
    <div class="col-6 text-center">
      <a class="nes-btn is-primary" href="https://limeincofficial.github.io/lime/post/">
        Back
      </a>
    </div>

    <div class="col-6 text-center">
      <a class="nes-btn is-primary" href="https://limeincofficial.github.io/lime/">
        Home
      </a>
    </div>
  </div>

</aside>

  </main>

  <footer>
  <div class="fixed-bottom p-3 bg-dark text-muted text-center">
    <small>
      Copyright &copy; 2020-2022 - Lime .inc
    </small>
  </div>
</footer>
<script src="https://limeincofficial.github.io/lime/js/bundle.min.a05a720c034d37023e437164a9b1b96a46524be90dff41570e4f0fb2aa47afe76c231af65931effd71ac5b56babf7c835ae3115bd4a47d1cf3ba7d35d48f6005.js" integrity="sha512-oFpyDANNNwI&#43;Q3FkqbG5akZSS&#43;kN/0FXDk8PsqpHr&#43;dsIxr2WTHv/XGsW1a6v3yDWuMRW9SkfRzzun011I9gBQ=="></script>

</body>

</html>
